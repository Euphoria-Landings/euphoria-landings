<!doctype html>
<html lang="uz">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Euphoria Elite Control â€¢ Monitoring</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Public Sans", sans-serif;
        background-color: #020408;
        color: #94a3b8;
        margin: 0;
      }
      .joy-card {
        background: rgba(11, 13, 14, 0.6);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 16px;
      }
      #sync-loader {
        position: fixed;
        top: 0;
        left: 0;
        height: 3px;
        background: linear-gradient(90deg, #0b6bcb, #1f7a1f, #0b6bcb);
        background-size: 200% 100%;
        width: 0%;
        opacity: 0;
        z-index: 1000;
        transition:
          width 0.4s ease-in-out,
          opacity 0.3s;
      }
      .syncing #sync-loader {
        opacity: 1;
        animation: progressMove 2s infinite linear;
      }
      @keyframes progressMove {
        0% {
          width: 0%;
          background-position: 100% 0;
        }
        100% {
          width: 100%;
          background-position: -100% 0;
        }
      }
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-thumb {
        background: #171a1c;
        border-radius: 10px;
      }
    </style>
  </head>
  <body>
    <div id="sync-loader"></div>

    <div class="flex min-h-screen">
      <aside
        class="w-64 border-r border-white/5 bg-[#0B0D0E] hidden lg:flex flex-col p-6 sticky top-0 h-screen"
      >
        <div class="flex items-center gap-3 mb-10">
          <div
            class="w-9 h-9 bg-[#0B6BCB] rounded-lg flex items-center justify-center text-white font-bold shadow-[0_0_15px_rgba(11,107,203,0.3)]"
          >
            E
          </div>
          <h1 class="text-white font-bold text-lg tracking-tight">
            Euphoria <span class="text-[#0B6BCB]">Ops</span>
          </h1>
        </div>
        <nav class="space-y-1">
          <div
            class="text-[10px] font-bold text-gray-600 uppercase tracking-widest mb-3 px-3"
          >
            Asosiy
          </div>
          <a
            href="#"
            class="flex items-center gap-3 text-[#99C8FF] bg-[#0B2240] px-3 py-2 rounded-md font-medium border border-[#0B6BCB]/20"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"
              />
            </svg>
            Dashboard
          </a>
        </nav>
        <div class="mt-auto p-4 joy-card bg-white/[0.02]">
          <p class="text-[10px] text-gray-500 mb-2 uppercase tracking-tighter">
            Server Status
          </p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-white font-medium">95.217.191.63</span>
            <span
              class="w-2 h-2 bg-green-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(34,197,94,0.6)]"
            ></span>
          </div>
        </div>
      </aside>

      <main class="flex-1 p-8 lg:p-12 max-w-6xl mx-auto w-full">
        <div
          class="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10"
        >
          <div>
            <h2 class="text-3xl font-bold text-white tracking-tight">
              Infratuzilma Monitoringi
            </h2>
            <p class="text-gray-500 text-sm mt-1">
              Barcha landing sahifalar uchun markaziy boshqaruv
            </p>
          </div>
          <button
            onclick="fetchData()"
            class="group flex items-center gap-2 px-5 py-2.5 bg-[#0B6BCB] hover:bg-[#185EA5] text-white rounded-lg transition-all font-semibold text-sm shadow-lg shadow-blue-900/20"
          >
            <svg
              class="w-4 h-4 group-active:rotate-180 transition-transform"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
              />
            </svg>
            Yangilash
          </button>
        </div>

        <div class="joy-card overflow-hidden shadow-2xl">
          <div class="overflow-x-auto min-h-[500px]">
            <table class="w-full text-left border-collapse">
              <thead>
                <tr class="border-b border-white/5 bg-white/[0.01]">
                  <th
                    class="px-6 py-4 text-[11px] font-bold uppercase tracking-widest text-gray-500"
                  >
                    Loyiha Nomi
                  </th>
                  <th
                    class="px-6 py-4 text-[11px] font-bold uppercase tracking-widest text-gray-500"
                  >
                    Port
                  </th>
                  <th
                    class="px-6 py-4 text-[11px] font-bold uppercase tracking-widest text-gray-500"
                  >
                    Holati
                  </th>
                  <th
                    class="px-6 py-4 text-[11px] font-bold uppercase tracking-widest text-gray-500 text-right"
                  >
                    Amal
                  </th>
                </tr>
              </thead>
              <tbody
                id="container-list"
                class="divide-y divide-white/5"
              ></tbody>
            </table>
          </div>

          <div
            class="px-6 py-4 flex items-center justify-between bg-white/[0.01] border-t border-white/5"
          >
            <p class="text-xs text-gray-500 italic" id="status-text">
              Yuklanmoqda...
            </p>
            <div class="flex items-center gap-4">
              <span class="text-[11px] text-gray-500" id="page-info"
                >Sahifa 1 / 1</span
              >
              <div class="flex items-center gap-2">
                <button
                  onclick="prevPage()"
                  id="prevBtn"
                  class="p-2 rounded-md border border-white/10 text-gray-500 hover:bg-white/5 disabled:opacity-30 disabled:cursor-not-allowed transition-all"
                >
                  <svg
                    class="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 19l-7-7 7-7"
                    />
                  </svg>
                </button>
                <button
                  onclick="nextPage()"
                  id="nextBtn"
                  class="p-2 rounded-md border border-white/10 text-gray-500 hover:bg-white/5 disabled:opacity-30 disabled:cursor-not-allowed transition-all"
                >
                  <svg
                    class="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 5l7 7-7 7"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      const SERVER_IP = "95.217.191.63";
      let allContainers = [];
      let currentPage = 1;
      const rowsPerPage = 7;

      const portMap = {
        artrowell: 3001,
        "cardio-balance": 3002,
        dermozil: 3003,
        diabetikforte: 3004,
        diastop: 3005,
        fatality: 3006,
        "gemo-plus": 3007,
        gipertofort: 3008,
        "parazit-off": 3009,
        slimfit: 3010,
        sustaflex: 3011,
        urion: 3012,
        "uro-pro": 3013,
        visucaps: 3014,
        growx: 3015,
        dashboard: 8080,
      };

      async function fetchData() {
        document.body.classList.add("syncing");
        try {
          const response = await fetch("data.json");
          allContainers = await response.json();
          renderTable();
          document.getElementById("status-text").innerText =
            `Jami: ${allContainers.length} ta konteyner`;
        } catch (error) {
          console.error("Fetch failed", error);
          document.getElementById("status-text").innerText =
            "Ma'lumotlarni yuklashda xatolik";
        } finally {
          setTimeout(() => document.body.classList.remove("syncing"), 800);
        }
      }

      function renderTable() {
        const list = document.getElementById("container-list");
        list.innerHTML = "";

        const start = (currentPage - 1) * rowsPerPage;
        const end = start + rowsPerPage;
        const paginatedItems = allContainers.slice(start, end);

        paginatedItems.forEach((c) => {
          const cleanName = c.name
            .replace("euphoria-landings-", "")
            .replace("euphoria-lands-", "")
            .replace("-1", "");

          const port = portMap[cleanName] || "---";
          const isUp = c.status.toLowerCase().includes("up");

          // IDEAL LINK: Har doim IP:PORT formatida ochiladi
          const link = `http://${SERVER_IP}:${port}/`;

          list.innerHTML += `
            <tr class="group hover:bg-white/[0.02] transition-colors">
                <td class="px-6 py-5">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded bg-[#171A1C] flex items-center justify-center text-[10px]">ðŸ“¦</div>
                        <span class="text-white font-medium text-sm capitalize">${cleanName}</span>
                    </div>
                </td>
                <td class="px-6 py-5 font-mono text-[11px] text-gray-500">${port}</td>
                <td class="px-6 py-5">
                    <span class="inline-flex items-center gap-1.5 px-2 py-0.5 rounded text-[10px] font-bold ${isUp ? "bg-green-500/10 text-green-400 border border-green-500/20" : "bg-red-500/10 text-red-400 border border-red-500/20"}">
                        <span class="w-1.5 h-1.5 rounded-full ${isUp ? "bg-green-500 shadow-[0_0_5px_#22c55e]" : "bg-red-500"}"></span>
                        ${isUp ? "RUNNING" : "STOPPED"}
                    </span>
                </td>
                <td class="px-6 py-5 text-right">
                    <a href="${link}" target="_blank" 
                       class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded text-[11px] font-bold text-[#99C8FF] hover:bg-[#0B2240] border border-transparent hover:border-[#0B6BCB]/30 transition-all">
                        OCHISH <span>â†—</span>
                    </a>
                </td>
            </tr>
          `;
        });

        updatePaginationUI();
      }

      function updatePaginationUI() {
        const totalPages = Math.ceil(allContainers.length / rowsPerPage);
        document.getElementById("page-info").innerText =
          `Sahifa ${currentPage} / ${totalPages || 1}`;
        document.getElementById("prevBtn").disabled = currentPage === 1;
        document.getElementById("nextBtn").disabled =
          currentPage === totalPages || totalPages === 0;
      }

      function prevPage() {
        if (currentPage > 1) {
          currentPage--;
          renderTable();
        }
      }
      function nextPage() {
        if (currentPage < Math.ceil(allContainers.length / rowsPerPage)) {
          currentPage++;
          renderTable();
        }
      }

      setInterval(fetchData, 10000);
      fetchData();
    </script>
  </body>
</html>
